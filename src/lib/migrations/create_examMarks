CREATE TABLE IF NOT EXISTS faculty (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    department  TEXT NOT NULL,
    batch TEXT,
    password TEXT NOT NULL
);
CREATE TABLE IF NOT EXISTS students (
	id	INTEGER,
	name	TEXT NOT NULL,
	email	TEXT NOT NULL UNIQUE,
	department	TEXT NOT NULL,
	password	TEXT NOT NULL,
	batch	TEXT,
	PRIMARY KEY("id" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS subjects (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    code TEXT UNIQUE NOT NULL,
    department  TEXT NOT NULL,
    description TEXT NOT NULL,
    type TEXT NOT NULL
);
--create a table for batches
CREATE TABLE IF NOT EXISTS batches (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    department  TEXT NOT NULL,
    semester TEXT NOT NULL,
    year TEXT NOT NULL,
    facultyIncharge TEXT NOT NULL,
    subjects TEXT 
);
--create a table for the subject basket for a semester with subjects as an array,department,semester with department and semester as unique
CREATE TABLE IF NOT EXISTS Basket (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    department TEXT NOT NULL,
    semester TEXT NOT NULL,
    subjects TEXT NOT NULL,
    UNIQUE(department,semester)
);

CREATE TABLE IF NOT EXISTS facultyoperation (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    faculty_id INTEGER NOT NULL,
    subject_id INTEGER NOT NULL,
    batch_id TEXT NOT NULL,
    semester TEXT NOT NULL,
    department TEXT NOT NULL,
    UNIQUE(faculty_id,subject_id,batch_id)
);

CREATE TABLE IF NOT EXISTS timetable (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    department TEXT NOT NULL,
    semester TEXT NOT NULL,
    batch_id TEXT NOT NULL,
    timetable TEXT NOT NULL,
    tbl_fileName TEXT NOT NULL,
    UNIQUE(department,semester,batch_id)
);

-- to execute the migration sqlite3 ./db/database.db < migrations/create_timetable.sql
CREATE TABLE IF NOT EXISTS exams (
	exam_id	INTEGER NOT NULL,
	exam_type	TEXT NOT NULL,
	max_mark	REAL NOT NULL,
	min_mark	REAL NOT NULL,
	exam_date	TEXT NOT NULL,
	department	TEXT NOT NULL,
	semester	TEXT NOT NULL,
	batch	TEXT NOT NULL,
	UNIQUE(batch,semester,department,exam_date),
	PRIMARY KEY(exam_id AUTOINCREMENT)
);
CREATE TABLE exam_marks (
	exam_id	INTEGER NOT NULL,
	subject_id	INTEGER NOT NULL,
	student_id	INTEGER NOT NULL,
	marks	REAL,
	UNIQUE(exam_id,subject_id,student_id),
	FOREIGN KEY(exam_id) REFERENCES exams(exam_id)
);
CREATE TABLE IF NOT EXISTS attendance (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  student_id INTEGER NOT NULL,
  subject_code INTEGER NOT NULL,
  date DATE NOT NULL,
  period INTEGER NOT NULL,
  status TEXT NOT NULL,
  );